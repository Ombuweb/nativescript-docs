<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Webpack :: NativeScript Documentation</title>
    <link rel="canonical" href="http://localhost:3000/running-and-building/webpack.html">
    <link rel="prev" href="../basics/tutorial/plain.html">
    <link rel="next" href="../ui-and-styling/app-resources.html">
    <meta name="generator" content="Antora 3.0.2">

  <link id="theme" rel="stylesheet" title="Default" href="../_/css/site.css">
  <link rel="stylesheet" title="Dark" href="../_/css/dark-site.css">

    <script>var uiRootPath = '../_'</script>
    <script src="../_/js/vendor/medium-zoom.js"></script>
    <script type="text/javascript" id="Cookiebot" src="https://consent.cookiebot.com/uc.js" data-cbid="e4db29b5-cd94-4bcf-87e4-04f4ca564240" data-blockingmode="manual"></script>

<link rel="icon" href="../_/img/favicon.png" type="image/x-icon">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <div class="top-logo">
        <a href=".." class="lisk-logo"></a>
        <a href=".." class="docs-logo"></a>
      </div>
      <!--<a class="navbar-item" href="http://localhost:3000">NativeScript Documentation</a>-->
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">APIs</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="../xxx/api-ref.html">NativeScript API</a>
<!--
add more items here if needed
-->
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Plugins</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="https://nativescript.com" target="_blank">NativeScript Plugins</a>
<!--
add more items here if needed
-->
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Documentation</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="../index.html">NativeScript Documentation</a>
<!--
  add more items here if needed
-->
          </div>
        </div>
        <button onclick="switch_style('toggle')" id="theme-toggle" class="theme-toggle navbar-item"></button>
      </div>
    </div>
  </nav>
</header><div class="toolbar" role="navigation">
  <button class="nav-toggle"></button>
  <div class="components-versions">
      <div class="page-components">
    <button class="component-menu-toggle" title="Show other documentations">NativeScript Documentation</button>
    <div class="component-menu">
        <a class="component is-current" href="../index.html">NativeScript Documentation</a>
    </div>
  </div>
    <span></span>
      </div>
  <span></span>
  <span></span>
  <a href="../index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">NativeScript Documentation</a></li>
    <li>Running and building</li>
    <li><a href="webpack.html">Webpack</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="file:///Users/ohmynuts/Documents/GitHub/nativescript-docs//docs/modules/ROOT/pages/running-and-building/webpack.adoc"><img class="pencil">Edit this Page</a></div>
</div>
<div class="body">
<div class="nav-container" data-component="ROOT" data-version="">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">NativeScript Documentation</a></h3>
<ul class="nav-list">
  <li class="nav-item parent" data-depth="0">
<ul class="nav-list">
  <li class="nav-item parent" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Basics</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../basics/index.html">Nativescript Basics</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../basics/environment-setup.html">Environment Setup</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../basics/development-workflow.html">Development Workflow</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../basics/understanding-packages.html">Understanding @nativescript</a>
  </li>
  <li class="nav-item parent" data-depth="2">
    <button class="nav-item-toggle"></button>
        <span>
    <a class="nav-link" href="../basics/tutorial/index.html">Tutorials</a>
        </span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../basics/tutorial/angular.html">Angular Tutorial</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../basics/tutorial/react.html">React Tutorial</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../basics/tutorial/vue.html">Vue Tutorial</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../basics/tutorial/svelte.html">Svelte Tutorial</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../basics/tutorial/plain.html">Plain Tutorial</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item parent" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Running and building</span>
<ul class="nav-list">
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="webpack.html">Webpack</a>
  </li>
</ul>
  </li>
  <li class="nav-item parent" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">UI and Styling</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../ui-and-styling/app-resources.html">Understanding App_Resources</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../ui-and-styling/ui-and-styling.html">UI &amp; Styling</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../ui-and-styling/interaction.html">Interaction</a>
  </li>
</ul>
  </li>
  <li class="nav-item parent" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Networking</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../networking/http.html">Http</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../networking/connectivity.html">Connectivity</a>
  </li>
</ul>
  </li>
  <li class="nav-item parent" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Scalability</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../scalability/code-sharing.html">Code Sharing</a>
  </li>
</ul>
  </li>
  <li class="nav-item parent" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Native API Access</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../native-api-access/access-and-use.html">Accessing Native Platform APIs</a>
  </li>
</ul>
  </li>
  <li class="nav-item parent" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Advanced Concepts</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../advanced-concepts/advanced-concepts.html">Advanced Concepts</a>
  </li>
</ul>
  </li>
  <li class="nav-item parent" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Distribution</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#distribution/releasing.adoc">distribution/releasing.adoc</a>
  </li>
</ul>
  </li>
  <li class="nav-item parent" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Troubleshooting</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../troubleshooting/troubleshooting.html">Troubleshooting Common Issues</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">NativeScript Documentation</span>
    <span class="version">default</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="../index.html">NativeScript Documentation</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">default</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Webpack</h1>
<div class="sect1">
<h2 id="webpack"><a class="anchor" href="#webpack"></a>Webpack</h2>
<div class="sectionbody">
<div class="paragraph">
<p>:::warning Note
This section is only aplicable to <code>@nativescript/webpack</code> version <code>5.0.0</code> and above.
If you are using an older version, consider upgrading. This is compatible with webpack version 5.x.
:::</p>
</div>
<div class="paragraph">
<p>All NativeScript applications are bundled using webpack. To manage the required configuration, we maintain the <code>@nativescript/webpack</code> package.</p>
</div>
<div class="paragraph">
<p>All new projects come with the base <code>webpack.config.js</code> that&#8217;s pre-configured to build a NativeScript app:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-js hljs" data-lang="js">const webpack = require('@nativescript/webpack')

module.exports = env =&gt; {
  webpack.init(env)

  // Learn how to customize:
  // https://docs.nativescript.org/webpack

  return webpack.resolveConfig()
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The above config configures most things required to bundle a NativeScript application. Internally it&#8217;s using <a href="https://github.com/neutrinojs/webpack-chain">webpack-chain</a> to generate the final config that is passed to webpack.</p>
</div>
<div class="paragraph">
<p>In some cases you may wish to extend the configuration, which is possible using the <a href="#api">API</a> for applications, and the <a href="#plugin-api">Plugin API</a> for plugins. This page contains many examples of common things you might want to change in the <a href="#examples-of-configurations">Examples of configurations section</a> - for anything else not mentioned here, refer to the <a href="https://github.com/neutrinojs/webpack-chain">webpack-chain documentation</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="flags-their-usage"><a class="anchor" href="#flags-their-usage"></a>Flags &amp; their usage</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="cli-flags"><a class="anchor" href="#cli-flags"></a>CLI flags</h3>
<div class="paragraph">
<p>When running a NativeScript app the following flags have an effect on the webpack config:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>--no-hmr</code> - disable HMR (enabled by default)</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="env-flags"><a class="anchor" href="#env-flags"></a>--env flags</h3>
<div class="paragraph">
<p>The following <code>--env</code> flags can be passed to the cli when running or building:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>--env.verbose</code> - prints verbose logs and the internal config before building</p>
</li>
<li>
<p><code>--env.replace=from:to</code> - add file replacement rules. For source files (<code>.js</code> and <code>.ts</code>) this will add a new alias to the config, for everything else, this will add a new copy rule. Example: <code>--env.replace=./src/environments/environment.ts:./src/environments/environment.prod.ts</code> would add an alias so when you <code>import { environment } from './environments/environment.ts'</code> it will resolve &amp; import from <code>./environments/environment.prod.ts</code>.</p>
</li>
<li>
<p><code>--env.appComponents</code> - allows passing additional App Components for android. For example if you have a custom activity in <code>myCustomActivity.ts</code> you can pass <code>--env.appComponents=myCustomActivity.ts</code>.</p>
</li>
<li>
<p><code>--env.production</code> - enable production mode (will minify the code)</p>
</li>
<li>
<p><code>--env.report</code> - generate a report with the BundleAnalyzerPlugin</p>
</li>
<li>
<p><code>--env.profile</code> - generate a <code>webpack.stats.json</code> to analyze on <a href="https://webpack.github.io/analyse/" class="bare">https://webpack.github.io/analyse/</a></p>
</li>
<li>
<p><code>--env.watchNodeModules</code> - enable watching <code>node_modules</code> for changes. Useful when debugging plugins and making changes directly in <code>node_modules</code>.</p>
</li>
<li>
<p><code>--env.e2e</code> - enables E2E (end-to-end) mode - this currently enables the <code>testID</code> property in <code>@nativescript/core</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>More env flags that are usually passed by the CLI automatically:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>--env.appPath</code> - path to the app source (same as <code>appPath</code> in the <code>nativescript.config.ts</code>)</p>
</li>
<li>
<p><code>--env.appResourcesPath</code> - path to App_Resources (same as <code>appResourcesPath</code> in the <code>nativescript.config.ts</code>)</p>
</li>
<li>
<p><code>--env.nativescriptLibPath</code> - path to the currently running CLI&#8217;s library.</p>
</li>
<li>
<p><code>--env.android</code> - <code>true</code> if running on android</p>
</li>
<li>
<p><code>--env.ios</code> - <code>true</code> if running on ios</p>
</li>
<li>
<p><code>--env.platform=&lt;platform&gt;</code> - for specifying the platform to use. Can be <code>android</code> or <code>ios</code>, or a custom platform in the future.</p>
</li>
<li>
<p><code>--env.hmr</code> - <code>true</code> if building with HMR enabled</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="using-env-files"><a class="anchor" href="#using-env-files"></a>Using .env files</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="https://github.com/mrsteele/dotenv-webpack">DotEnv</a> is pre-configured to allow defining environment variables available during runtime. You can create a <code>.env</code> file in your project root and define values that will be available to your app during runtime.</p>
</div>
<div class="paragraph">
<p>In case you need multiple environments, you can create additional env files with the naming convention of <code>.env.&lt;name&gt;</code> (e.g. <code>.env.prod</code>, <code>.env.staging</code>).</p>
</div>
<div class="paragraph">
<p>The following logic is used when loading environment files:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>.env</code> is loaded by default if found</p>
</li>
<li>
<p><code>.env.&lt;name&gt;</code> is loaded when <code>--env.env=&lt;name&gt;</code> is passed to the build/run command and <code>.env.&lt;name&gt;</code> exists, otherwise it falls back to loading <code>.env</code> (if found)</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="example-env-and-env-prod-files"><a class="anchor" href="#example-env-and-env-prod-files"></a>Example .env and .env.prod files</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"># example .env file
MY_API_ENDPOINT=https://staging-api-host/api/v2
MY_API_SECRET=supersecrettoken</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"># example .env.prod file
MY_API_ENDPOINT=https://production-api-host/api/v2
MY_API_SECRET=verysuperverysecretverytoken</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">// example usage - loaded from .env by default
console.log(process.env.MY_API_ENDPOINT) // https://staging-api-host/api/v2
console.log(process.env.MY_API_SECRET) // supersecrettoken

// --env.env=prod: loaded from .env.prod
console.log(process.env.MY_API_ENDPOINT) // https://production-api-host/api/v2
console.log(process.env.MY_API_SECRET) // verysuperverysecretverytoken

// --env.env=nonexistent: falls back to .env
console.log(process.env.MY_API_ENDPOINT) // https://staging-api-host/api/v2
console.log(process.env.MY_API_SECRET) // supersecrettoken</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">:</dt>
<dd>
<p>warning Note</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Please note that the way DotEnv works is it&#8217;s using the webpack <a href="#extending-the-defineplugin-options">DefinePlugin</a> internally to define the <code>process.env.&lt;x&gt;</code> values, meaning they are essentially statically replaced in the bundled code. This is important to keep in mind because destructuring, looping etc over <code>process</code> or <code>process.env</code> is not possible.</p>
</div>
<div class="paragraph">
<p>See details about the limitations in the <a href="https://github.com/mrsteele/dotenv-webpack#limitations">DotEnv documentation</a></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">:</dt>
<dd>
<p>== Global "magic" variables</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>We define a few useful globally available variables:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code><em>DEV</em></code> - true when webpack is building in development mode</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">if (__DEV__) {
  // we are running a dev build
}</code></pre>
</div>
</div>
</li>
<li>
<p><code>global.isAndroid</code>, <code><em>ANDROID</em></code> - true when the platform is Android</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">if (global.isAndroid) {
  // we are running on android
}</code></pre>
</div>
</div>
</li>
<li>
<p><code>global.isIOS</code>, <code><em>IOS</em></code> - true when the platform is iOS</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">if (global.isIOS) {
  // we are running on iOS
}
----+++&lt;details&gt;++++++&lt;summary&gt;+++The following variables are also defined, but are primarily intended to be used by NativeScript Core internally, or plugins that wish to use these.+++&lt;/summary&gt;+++ - `__NS_WEBPACK__` - always `true` when building with webpack - `__NS_ENV_VERBOSE__` - `true` when `--env.verbose` is set - `__NS_DEV_HOST_IPS__` - an array of IP addresses of the host machine (the machine running the build) when in `development` mode, and an empty array in production mode. - `__CSS_PARSER__` - the css parser used by NativeScript Core. The value is set based on the `cssParser` value in the `nativescript.config.ts` and defaults to `css-tree` - `__UI_USE_XML_PARSER__` - a flag used by NativeScript Core to disable the XML parser when it's not used - `__UI_USE_EXTERNAL_RENDERER__` - a flag used by NativeScript Core to disable registering global modules when an external renderer is used.+++&lt;/details&gt;+++

== Examples of configurations

Here are some common examples of things you may want to do in your `webpack.config.js`.

Note that the config is built using https://github.com/neutrinojs/webpack-chain[webpack-chain], so the `config` variable in all the examples below are instances of a chainable config. You can find more examples in webpack-chain's documentation as well as read the https://github.com/NativeScript/NativeScript/tree/fb2c29106378f21583d890174f1c5a6bca6e6b8a/packages/webpack5/src/configuration[source of the base configs] to see how we implemented them.

=== Adding a copy rule

[,js]</code></pre>
</div>
</div>
<div class="paragraph">
<p>const webpack = require('@nativescript/webpack')</p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>module.exports = env &#8658; {
  webpack.init(env)</p>
</div>
<div class="literalblock">
<div class="content">
<pre>// Example: copy all markdown files to the build directory
webpack.Utils.addCopyRule('**/*.md')</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>// Example: copy all files from a dependency
webpack.Utils.addCopyRule({
  from: '@nativescript/webpack/stubs',
  to: 'custom/location',
  // the context of the "from" rule, in this case node_modules
  // we used the getProjectFilePath util here, but this could have been
  // a path.resolve(__dirname, 'node_modules') too.
  context: webpack.Utils.project.getProjectFilePath('node_modules')
})</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>  return webpack.resolveConfig()
}</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>For all the valid options you can pass, refer to the https://webpack.js.org/plugins/copy-webpack-plugin/#patterns[CopyWebpackPlugin Documentation]

=== Adding a plugin

[,js]</pre>
</div>
</div>
<div class="paragraph">
<p>const webpack = require('@nativescript/webpack')</p>
</div>
<div class="paragraph">
<p>const { BannerPlugin } = require('webpack')</p>
</div>
<div class="paragraph">
<p>module.exports = env &#8658; {
  webpack.init(env)</p>
</div>
<div class="literalblock">
<div class="content">
<pre>// first we add our callback to the internal chain
webpack.chainWebpack(config =&gt; {
  // we add the plugin
  config.plugin('BannerPlugin').use(BannerPlugin, [
    {
      banner: 'hello world'
    }
  ])
})</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>  return webpack.resolveConfig()
}</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>The second argument of the `.use` call is an array of arguments you would pass to the plugin. For example, the above example is converted from the official BannerPlugin docs that stated the following:

[,js]</pre>
</div>
</div>
<div class="paragraph">
<p>new webpack.BannerPlugin({
  banner: 'hello world'
})</p>
</div>
<div class="listingblock">
<div class="content">
<pre>=== Adding a resolver plugin

[,js]</pre>
</div>
</div>
<div class="paragraph">
<p>const webpack = require('@nativescript/webpack')
const TsconfigPathsPlugin = require('tsconfig-paths-webpack-plugin')</p>
</div>
<div class="paragraph">
<p>module.exports = env &#8658; {
  webpack.init(env)</p>
</div>
<div class="literalblock">
<div class="content">
<pre>webpack.chainWebpack(config =&gt; {
  config.resolve.plugin('TsconfigPathsPlugin').use(TsconfigPathsPlugin)
})</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>  return webpack.resolveConfig()
}</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>=== Adding a loader

[,js]</pre>
</div>
</div>
<div class="paragraph">
<p>const webpack = require('@nativescript/webpack')</p>
</div>
<div class="paragraph">
<p>module.exports = env &#8658; {
  webpack.init(env)</p>
</div>
<div class="literalblock">
<div class="content">
<pre>webpack.chainWebpack(config =&gt; {
  // add a new rule for *.something files
  config.module
    .rule('something')
    .test(/\.something$/)
    .use('something-loader')
    .loader('something-loader')
    .options({
      example: true
    })
})</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>  return webpack.resolveConfig()
}</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>=== Adding Externals

[,js]</pre>
</div>
</div>
<div class="paragraph">
<p>const webpack = require('@nativescript/webpack')</p>
</div>
<div class="paragraph">
<p>module.exports = env &#8658; {
  webpack.init(env)</p>
</div>
<div class="literalblock">
<div class="content">
<pre>webpack.chainWebpack(config =&gt; {
  config.externals(
    // make sure to keep pre-defined externals
    config.get('externals').concat([
      // add your own externals
      'some-external-dependency'
    ])
  )
})</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>  return webpack.resolveConfig()
}</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>=== Adding path aliases

You can define `import`-aliases for specific source directories.

[,js]</pre>
</div>
</div>
<div class="paragraph">
<p>const webpack = require('@nativescript/webpack')
const { resolve } = require('path')</p>
</div>
<div class="paragraph">
<p>module.exports = env &#8658; {
  webpack.init(env)</p>
</div>
<div class="literalblock">
<div class="content">
<pre>webpack.chainWebpack(config =&gt; {
  // change the "@" alias to "app/libs"
  config.resolve.alias.set('@', resolve(__dirname, 'app/libs'))
})</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>  return webpack.resolveConfig()
}</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>=== Extending the DefinePlugin options

[,js]</pre>
</div>
</div>
<div class="paragraph">
<p>const webpack = require('@nativescript/webpack')</p>
</div>
<div class="paragraph">
<p>module.exports = env &#8658; {
  webpack.init(env)</p>
</div>
<div class="literalblock">
<div class="content">
<pre>webpack.chainWebpack(config =&gt; {
  config.plugin('DefinePlugin').tap(args =&gt; {
    Object.assign(args[0], {
      'global.isProduction': !!env.production,
      'global.someNumber': 42,
      'global.someString': JSON.stringify('some string value')
    })</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>    return args
  })
})</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>  return webpack.resolveConfig()
}</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>=== Changing an existing rule

To change an existing rule, it's useful to know how it has been set up first:

[,cli]</pre>
</div>
</div>
<div class="paragraph">
<p>ns prepare android|ios --env.verbose
# Note: we plan to add a separate command to just print the internal config</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Will print the resolved internal config with helpful comments above each rule that you can grab and use. For example:

[,js]</pre>
</div>
</div>
<div class="paragraph">
<p>/* config.module.rule('js') <strong>/
{
  test: /\.js$/,
  exclude: [
    /node_modules/
  ],
  use: [
    /</strong> config.module.rule('js').use('babel-loader') */
    {
      loader: 'babel-loader',
      options: {
        generatorOpts: {
          compact: false
        }
      }
    }
  ]
},</p>
</div>
<div class="listingblock">
<div class="content">
<pre>To add a new loader, we can use the same syntax we used above for adding new loaders:

[,js]</pre>
</div>
</div>
<div class="paragraph">
<p>const webpack = require('@nativescript/webpack')</p>
</div>
<div class="paragraph">
<p>module.exports = env &#8658; {
  webpack.init(env)</p>
</div>
<div class="literalblock">
<div class="content">
<pre>webpack.chainWebpack(config =&gt; {
  config.module.rule('js').use('something-loader').loader('something-loader').options({
    example: true
  })
})</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>  return webpack.resolveConfig()
}</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>=== Changing an existing loader options

[,js]</pre>
</div>
</div>
<div class="paragraph">
<p>const webpack = require('@nativescript/webpack')</p>
</div>
<div class="paragraph">
<p>module.exports = env &#8658; {
  webpack.init(env)</p>
</div>
<div class="literalblock">
<div class="content">
<pre>webpack.chainWebpack(config =&gt; {
  config.module
    .rule('scss')
    .use('sass-loader')
    .options({ sassOptions: { indentedSyntax: true } })
})</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>  return webpack.resolveConfig()
}</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>=== Changing an existing plugin configuration

Let's change the BannerPlugin we added above:

[,js]</pre>
</div>
</div>
<div class="paragraph">
<p>const webpack = require('@nativescript/webpack')</p>
</div>
<div class="paragraph">
<p>module.exports = env &#8658; {
  webpack.init(env)</p>
</div>
<div class="literalblock">
<div class="content">
<pre>webpack.chainWebpack(config =&gt; {
  config.plugin('BannerPlugin').tap(args =&gt; {
    // args is and Array of all the arguments passed to the BannerPlugin constructor</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>// args[0] is the first argument, which we set above.
// be careful when accessing an array index
// and do proper checks before writing to
// avoid errors
args[0].banner = 'changed banner.'</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>    // should always return all the arguments that should be passed to the plugin constructor
    // in some cases you may want to remove an argument - you can do that by returning an array
    // with that argument removed from it.
    return args
  })
})</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>  return webpack.resolveConfig()
}</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>=== Explicitly set base config

In some cases, you may want to explicitly set which base config should be used.

For example in the NativeScript-Vue repo, the `sample` app doesn't have `nativescript-vue` listed as a dependency, so we have to specify the base config we want to use.

[,js]</pre>
</div>
</div>
<div class="paragraph">
<p>const webpack = require('@nativescript/webpack')</p>
</div>
<div class="paragraph">
<p>module.exports = env &#8658; {
  webpack.init(env)</p>
</div>
<div class="literalblock">
<div class="content">
<pre>// set the base config
// can be false to opt out from using a base config (used mostly in tests)
// or can be one of the base configs: base, angular, javascript, react, svelte, typescript, vue
webpack.useConfig('vue')</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>  return webpack.resolveConfig()
}</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>=== Suppressing warnings

If your build produces warnings that you want to hide, you can do that with the following:

[,js]</pre>
</div>
</div>
<div class="paragraph">
<p>const webpack = require('@nativescript/webpack')</p>
</div>
<div class="paragraph">
<p>module.exports = env &#8658; {
  webpack.init(env)</p>
</div>
<div class="literalblock">
<div class="content">
<pre>webpack.chainWebpack(config =&gt; {
  config.set(
    'ignoreWarnings',
    (config.get('ignoreWarnings') || []).concat([
      /a regex that matches the warning to suppress/
    ])
  )
})</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>  return webpack.resolveConfig()
}</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>=== Merging options into the config

For simple things, you can merge objects into the final config instead of using `chainWebpack`

[,js]</pre>
</div>
</div>
<div class="paragraph">
<p>const webpack = require('@nativescript/webpack')</p>
</div>
<div class="paragraph">
<p>module.exports = env &#8658; {
  webpack.init(env)</p>
</div>
<div class="literalblock">
<div class="content">
<pre>// merge a simple object
webpack.mergeWebpack({ mode: 'production' })</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>// using a function
webpack.mergeWebpack(env =&gt; {
  // return the object to be merged
  return {
    mode: 'production'
  }
})</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>  return webpack.resolveConfig()
}</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>== Plugin API

NativeScript plugins can provide a `nativescript.webpack.js` file in their root folder (next to `package.json`), and `@nativescript/webpack` will include these configs when resolving the final config.

For example, a plugin could register a new loader it requires:

[,js]</pre>
</div>
</div>
<div class="paragraph">
<p>/<strong>*
 * This optionally provides typehints
 * this requires "@nativescript/webpack" to be a dependency (dev)
 *
 * @param {typeof import("@nativescript/webpack")} webpack
 */
module.exports = webpack &#8658; {
  // same API as the user configs
  // for example make changes to the internal config with webpack-chain
  webpack.chainWebpack(
    (config, env) &#8658; {
      // as an example - add a new rule for svg files
      config.module
        .rule('something')
        .test(/\.something$/)
        .use('something-loader')
        .loader('something-loader')
    } /</strong>, options */
  )
}</p>
</div>
<div class="listingblock">
<div class="content">
<pre>== API

=== webpack.init(env: IWebpackEnv)

*Required*: initialize the internal `env` object that's used throughout the config building process.

The passed env should be an object containing key-value pairs. This is generally handled by webpack.

=== webpack.useConfig(config: string | false)

_Optional_: specify base config - defaults to auto-discovery.

Passing `false` will opt-out from using a base config, however this is generally never recommended.

=== webpack.chainWebpack(chainFn, options?)

_Optional_: add a new `chainFn` to the internal chain that will be called while resolving the final config.

The `chainFn` should be a function that accepts 2 parameters &amp;mdash; `config` and `env`.

The `options` is an optional object with the following optional properties:

* `order: number`: controls the order in which the `chainFn` should be applied.
+
Useful when related plugins rely on changes made in the right order. For example, `plugin1` can specify `order: 1` and `plugin2` can specify `order: 2` - this will guarantee that ``plugin1``'s `chainFn` is called first, and that `plugin2` can rely on values set by `plugin1`.

*Example: Force production mode*

[,js]</pre>
</div>
</div>
<div class="paragraph">
<p>webpack.chainWebpack((config, env) &#8658; {
  config.mode('production')
})</p>
</div>
<div class="listingblock">
<div class="content">
<pre>*Example: Run a config "last"*

Setting `order: 10` doesn't necessarily guarantee the `chainFn` will be applied last, since other calls to `chainWebpack` could specify a higher number. We recommend against setting higher values, and using `10` as a conventional "last".

[,js]</pre>
</div>
</div>
<div class="paragraph">
<p>webpack.chainWebpack(
  (config, env) &#8658; {
    config.set('somethingThatShouldBeSetLast', true)
  },
  { order: 10 }
)</p>
</div>
<div class="listingblock">
<div class="content">
<pre>=== webpack.mergeWebpack(mergeFnOrObject)

_Optional_: merges an object (or an object returned by a function) into the resolved chain config.

*Example*

[,js]</pre>
</div>
</div>
<div class="paragraph">
<p>webpack.mergeWebpack({
  something: true
})
webpack.mergeWebpack(env &#8658; {
  return {
    something: true
  }
})</p>
</div>
<div class="listingblock">
<div class="content">
<pre>=== webpack.resolveChainableConfig()

Resolve a new instance of the internal chain config with all chain functions applied.

=== webpack.resolveConfig()

Resolve a "final" configuration that has all chain functions and merges applied.

This returns a config that webpack can process.</pre>
</div>
</div>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="../basics/tutorial/plain.html">Plain Tutorial</a></span>
  <span class="next"><a href="../ui-and-styling/app-resources.html">Understanding App_Resources</a></span>
</nav>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <div class="footerdiv">
    <p>© 2022 OpenJS Foundation</p>
    <div class="community_icons">
        <a href="https://nativescript.org/discord" title="Discord" target="_blank" class="footer_icon icon-discord"><p>Discord</p></a>
        <a href="https://twitter.com/NativeScript" title="Twitter" target="_blank" class="footer_icon icon-discourse"><p>Twitter</p></a>
        <a href="https://github.com/NativeScript/NativeScript" title="GitHub" target="_blank" class="footer_icon icon-github"><p>GitHub</p></a>
  <!--    </div> -->
    </div>
  </div>
</footer>
<script src="../_/js/site.js"></script>
<script async src="../_/js/vendor/highlight.js"></script>
<script async src="../_/js/vendor/tabs-block-behaviour.js"></script>
<script async src="../_/js/vendor/swagger-ui.js"></script>
<script async src="../_/js/vendor/component-versions.js"></script>
<script src="../_/js/vendor/custom.js"></script>
  </body>
</html>
